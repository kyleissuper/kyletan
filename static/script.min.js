Element.prototype.remove=function(){this.parentElement.removeChild(this);}NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var i=this.length-1;i>=0;i--){if(this[i]&&this[i].parentElement){this[i].parentElement.removeChild(this[i]);}}}var popAvail=1;function newListeners(){popAvail=1;window.addEventListener("popstate",function(evt){if(popAvail===1){popAvail=0;if(document.URL==="http://128.199.155.92:8081/"){AJAX.direction="-";}else{AJAX.direction="+";};AJAX.request(document.referrer);};});Array.prototype.forEach.call(document.getElementsByClassName("card"),function cardElement(el){el.addEventListener("click",function cardListener(evt){evt.preventDefault();this.classList.add("delayed");AJAX.direction="+";AJAX.request(this.href);});});Array.prototype.forEach.call(document.getElementsByClassName("back"),function cardElement(el){el.addEventListener("click",function cardListener(evt){evt.preventDefault();AJAX.direction="-";AJAX.request(this.href);});});};newListeners();function raiseError(url,error){window.location.href=url;};var AJAX={threshold:100,response:{},animateQ:[],renameOld:function renameOld(){Object.keys(AJAX.oldElements).forEach(function loopThroughClasses(c){var i=0;Array.prototype.forEach.call(document.getElementsByClassName(c),function renameElement(el){el.classList.add("old");el.id=c+"-old-"+i;AJAX.oldElements[c].push(c+"-old-"+i);i++;});});},loadNew:function loadNew(){var body=document.getElementsByTagName("body")[0];body.innerHTML+=AJAX.html;Object.keys(AJAX.newElements).forEach(function loopThroughClasses(c){var i=0;Array.prototype.forEach.call(document.getElementsByClassName(c),function renameElement(el){if(!el.classList.contains("old")){el.id=c+"-new-"+i;AJAX.newElements[c].push(c+"-new-"+i);i++;};});});var image=document.createElement('img');image.src=document.getElementsByClassName('bg')[1].style.backgroundImage.replace(/url\(['"]?(.*?)['"]?\)/i,"$1");image.onload=AJAX.animate();},get_position:function getPosition(element){var xPosition=0;var yPosition=0;while(element){xPosition+=(element.offsetLeft-element.scrollLeft+element.clientLeft);yPosition+=(element.offsetTop-element.scrollTop+element.clientTop);element=element.offsetParent;}return{x:xPosition,y:yPosition};},animate:function animate(){Velocity(document.getElementById("bg-old-0"),{opacity:0},{duration:350});AJAX.oldElements.animate_rise.forEach(function(id){var el=document.getElementById(id);el.temp_data={height:el.clientHeight-getComputedStyle(el,null).paddingTop-getComputedStyle(el,null).paddingBottom,width:el.clientWidth-getComputedStyle(el,null).paddingLeft-getComputedStyle(el,null).paddingRight,margins:[getComputedStyle(el,null).marginTop.slice(0,-2)-0,getComputedStyle(el,null).marginRight.slice(0,-2)-0,getComputedStyle(el,null).marginBottom.slice(0,-2)-0,getComputedStyle(el,null).marginLeft.slice(0,-2)-0],position:AJAX.get_position(el)};});AJAX.oldElements.animate_fade.forEach(function(id){var el=document.getElementById(id);el.temp_data={height:el.clientHeight-getComputedStyle(el,null).paddingTop-getComputedStyle(el,null).paddingBottom,width:el.clientWidth-getComputedStyle(el,null).paddingLeft-getComputedStyle(el,null).paddingRight,margins:[getComputedStyle(el,null).marginTop.slice(0,-2)-0,getComputedStyle(el,null).marginRight.slice(0,-2)-0,getComputedStyle(el,null).marginBottom.slice(0,-2)-0,getComputedStyle(el,null).marginLeft.slice(0,-2)-0],position:AJAX.get_position(el)};});var scrollY=window.scrollY;var body=document.body;body.style.height=body.scrollHeight+"px";body.style.overflow="hidden";AJAX.oldElements.animate_delete.forEach(function(id){var el=document.getElementById(id);el.style.position="relative";el.style.height="0px";el.style.width="0px";el.style.padding="0px";});AJAX.oldElements.animate_rise.forEach(function(id){var el=document.getElementById(id);el.style.position="absolute";el.style.height=el.temp_data.height+"px";el.style.width=el.temp_data.width+"px";el.style.top=el.temp_data.position.y+scrollY+"px";el.style.left=el.temp_data.position.x+"px";el.style.margin="0px";});AJAX.oldElements.animate_fade.forEach(function(id){var el=document.getElementById(id);el.style.position="absolute";el.style.height=el.temp_data.height+"px";el.style.width=el.temp_data.width+"px";el.style.top=el.temp_data.position.y+scrollY+"px";el.style.left=el.temp_data.position.x+"px";el.style.margin="0px";});AJAX.newElements.animate_rise.forEach(function(id){var el=document.getElementById(id),direction="+"===AJAX.direction?1:-1;el.style.opacity=0;el.style.marginTop=el.style.marginTop-(AJAX.threshold*direction)+"px";});AJAX.newElements.animate_fade.forEach(function(id){var el=document.getElementById(id);el.style.opacity=0;});Velocity(document.getElementsByTagName("body")[0],"scroll",{axis:"y"},{duration:400});AJAX.oldElements.animate_rise.forEach(function(id){var delay=0;if(document.getElementById(id).classList.contains("delayed")){delay=200;};Velocity(document.getElementById(id),{opacity:0,top:AJAX.direction+"="+AJAX.threshold+"px"},{duration:150+delay,delay:125});});AJAX.oldElements.animate_fade.forEach(function(id){var delay=0;if(document.getElementById(id).classList.contains("delayed")){delay=200;};Velocity(document.getElementById(id),{opacity:0},{duration:150+delay,delay:125});});AJAX.newElements.animate_rise.forEach(function(id){var delay=0;if(document.getElementById(id).classList.contains("delayed")){delay=100;};Velocity(document.getElementById(id),{opacity:1,marginTop:AJAX.direction+"="+AJAX.threshold+"px"},{duration:250,delay:125+delay});});AJAX.newElements.animate_fade.forEach(function(id){var delay=0;if(document.getElementById(id).classList.contains("delayed")){delay=100;};Velocity(document.getElementById(id),{opacity:1},{duration:250,delay:125+delay});});setTimeout(function(){document.getElementsByClassName("old").remove();window.history.pushState({path:AJAX.url},'',AJAX.url);newListeners();document.body.style.height="";document.body.style.overflow="";Array.prototype.forEach.call(document.getElementsByTagName("a"),function removeOpacity(el){el.style.opacity="";});},750);},callback:function callback(){if(AJAX.response.httpStatus!==200){raiseError(AJAX.url,"Connection error. Please re-try.");}else{AJAX.renameOld();AJAX.loadNew();};},requestChanged:function requestChanged(){if(this.readyState===4){if(this.status==200){AJAX.response.httpStatus=200;AJAX.response.content=this.responseText;AJAX.html=AJAX.response.content.split("<body>")[1];AJAX.html=AJAX.html.split("</body>")[0];}else{AJAX.response.httpStatus=this.status;};AJAX.callback();};},request:function request(url){this.httpRequest="";this.httpRequest=new XMLHttpRequest();this.url=url;this.response={httpStatus:"",content:""};this.oldElements={"back":[],"animate_fade":[],"animate_rise":[],"bg":[],"animate_delete":[]},this.newElements={"back":[],"animate_fade":[],"animate_rise":[],};if(!this.httpRequest){this.response.httpStatus="No AJAX";return;};this.httpRequest.onreadystatechange=this.requestChanged;this.httpRequest.open('GET',url,true);this.httpRequest.send();}};